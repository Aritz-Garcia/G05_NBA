@page "/"
@using NBA_FINAL_PROJECT.Model
@using System.Net.Http
@using System.Text.Json.Serialization
@inject HttpClient http
<div> 
    <input type="search" name="busqueda" />
</div>

@if (jugadores3 == null)
{
    <div class="spinner"></div>   
}else if(jugadores3!=null)
{
    <RadzenDataGrid Data="@jugadores3.data" TItem="Datum"
                AllowFiltering="true"
                AllowSorting="true"
                AllowPaging="true"
                PageSize="10">
    <Columns>
        <RadzenDataGridColumn TItem="Datum" Property="first_name" Title="Name" />
        <RadzenDataGridColumn TItem="Datum" Property="last_name" Title="Last Name" />
    </Columns>
</RadzenDataGrid>
}


@code{
    Jugador jugadores;
    Jugador jugadores2;
    Jugador jugadores3;

    protected override async Task OnInitializedAsync()
    {
        jugadores = await http.GetFromJsonAsync<Jugador>($"https://www.balldontlie.io/api/v1/players?per_page=100");
        for(int i=1; i<jugadores.meta.total_pages; i++)
        {
            jugadores2 = await http.GetFromJsonAsync<Jugador>($"https://www.balldontlie.io/api/v1/players?per_page=100&page={i}");
            
            if (jugadores3 == null)
            {
                jugadores3 = jugadores2;
            }
            else{
                jugadores3.data = jugadores2.data.Union(jugadores3.data).ToArray();
            }
        }
    }

}
